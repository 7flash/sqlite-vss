.bail on
.mode box
.header on

.load ../sqlite-bert/target/release/libbert0
.load build_release/faiss0

.timer on

select 
  sentence_embeddings.rowid,
  sentence_embeddings.distance,
  kh_sentences.sentence
from sentence_embeddings 
left join kh_sentences on kh_sentences.rowid = sentence_embeddings.rowid
where 
  faiss_search(
    vector, 
    faiss_search_params(
      --json('[0.023932088166475296,0.08389842510223389,-0.06180950626730919,0.007253490388393402,-0.04536417871713638,0.009748793207108974,-0.0035441566724330187,-0.014624221250414848,-0.016643986105918884,-0.018539905548095703,-0.026825182139873505,-0.05660756677389145,-0.054244838654994965,-0.01830420084297657,-0.057461176067590714,0.10715311765670776,-0.05422114208340645,-0.026317747309803963,-0.07861336320638657,0.011920538730919361,-0.0836857333779335,-0.02796567603945732,-0.006307296920567751,0.04215601831674576,-0.05397503450512886,-0.03460393846035004,0.026508577167987823,-0.0008442320977337658,0.016897151246666908,-0.06012841686606407,-0.0654226616024971,0.04133949801325798,0.0289643295109272,0.01002561766654253,0.04208334907889366,-0.03125014528632164,0.07095660269260406,0.11077942699193954,0.006256182678043842,0.044257402420043945,0.02799409255385399,0.0015185471856966615,-0.014291912317276001,0.03913820534944534,0.00842997431755066,0.04225451499223709,-0.02989143691956997,0.0029241819866001606,-0.04609460011124611,-0.01712856814265251,0.005221727769821882,-0.004582410212606192,0.0016966266557574272,-0.08640497922897339,0.021005863323807716,-0.023674771189689636,0.004844874609261751,-0.04278948903083801,-0.010186326690018177,0.05054871737957001,0.04808276891708374,-0.038013532757759094,-0.03291850537061691,0.045259322971105576,0.03660327196121216,-0.04196375235915184,0.12280204147100449,0.06133921816945076,0.0012913778191432357,0.025898173451423645,0.006408739369362593,0.02626614086329937,-0.005930921994149685,-0.09042001515626907,0.09456265717744827,0.02860318496823311,0.03721780329942703,-0.028868595138192177,-0.06876108050346375,-0.04150648042559624,0.04725929722189903,0.05368741229176521,0.015086979605257511,0.008184189908206463,-0.0819026455283165,-0.04049002751708031,-0.01645059324800968,0.0285672377794981,0.009771381504833698,0.016622578725218773,-0.021996276453137398,0.11335642635822296,0.05651792883872986,-0.062265850603580475,0.04090769961476326,0.03743626922369003,-0.06434910744428635,-0.04380600154399872,-0.027896607294678688,0.21237781643867493,-0.029461940750479698,-0.028523940593004227,0.019811086356639862,-0.0031776730902493,-0.04958140477538109,-0.04771900177001953,-0.019762827083468437,-0.009631602093577385,-0.06635670363903046,-0.012625725008547306,-0.08885735273361206,-0.06896967440843582,-0.07112249732017517,0.026445835828781128,0.0847473070025444,-0.07744304835796356,0.02467869594693184,0.01072089746594429,-0.01964353397488594,-0.01603400893509388,-0.025530489161610603,0.02900012582540512,-0.07635875046253204,-0.023275837302207947,0.06664635241031647,-0.09108410030603409,-0.08885404467582703,0.005617784336209297,0.024411171674728394,-0.13334566354751587,-0.0549718476831913,0.02111324481666088,0.008666733279824257,0.06950603425502777,-0.03508032485842705,0.04815180227160454,-0.027614329010248184,0.040735483169555664,0.001499189529567957,-0.00024236030003521591,0.005874055903404951,-0.019517337903380394,0.006410918198525906,0.040693603456020355,-0.06682083010673523,-0.014128376729786396,-0.048051074147224426,0.03148897364735603,0.03240836039185524,0.0696382224559784,-0.005605765152722597,0.09100239723920822,-0.06523381918668747,0.10247578471899033,0.014723282307386398,-0.023385683074593544,0.03707939013838768,-0.0013285669265314937,-0.03908349573612213,0.057498835027217865,0.008046521805226803,0.04327656328678131,0.008463344536721706,0.03144781291484833,0.07184793055057526,-0.03752562031149864,0.00025906041264533997,-0.04384138435125351,0.03934263810515404,0.017453433945775032,0.03178584948182106,0.04218079522252083,0.053296931087970734,-0.0052514574490487576,0.039605315774679184,0.004496190696954727,-0.10287638753652573,0.08984047919511795,-0.05479136109352112,0.01772700436413288,0.0360686294734478,-0.030514387413859367,0.028765864670276642,-0.045555610209703445,-0.0169204231351614,0.06550858914852142,0.0071258144453167915,-0.022602427750825882,0.009885339997708797,-0.02576250396668911,0.030433721840381622,-0.05937856063246727,0.07967519015073776,0.07868411391973495,0.01708660088479519,0.03550175949931145,-0.022456763312220573,-0.03691839054226875,-0.09094702452421188,0.031246356666088104,-0.04476041719317436,0.03042249009013176,-0.07728583365678787,0.030674094334244728,0.024241281673312187,-0.0867820456624031,-0.002615943318232894,-0.005234576296061277,0.017760062590241432,-0.023757832124829292,0.059964682906866074,-0.005901647266000509,0.00629172520712018,0.02300906926393509,-0.004390496760606766,-0.006532617844641209,0.08002389967441559,-0.00875332485884428,-0.05231378600001335,0.06963338702917099,0.054753683507442474,0.01949469745159149,0.038752052932977676,8.113126827525084e-33,-0.021372389048337936,-0.058034081012010574,-0.03753962740302086,0.03987014666199684,-0.03200988471508026,0.06990771740674973,0.07255899906158447,0.0029079876840114594,0.010054083541035652,0.027076877653598785,0.019610010087490082,-0.11241798847913742,0.07473265379667282,0.07102427631616592,-0.06468068808317184,-0.10648585855960846,0.010077321901917458,0.1637638807296753,0.09079500287771225,0.042165711522102356,0.0031252626795321703,0.014350317418575287,-0.004127056337893009,0.043865006417036057,-0.02295343205332756,0.05376069247722626,-0.031137043610215187,-0.10278251022100449,-0.0366118848323822,0.01681559532880783,0.10309696197509766,0.04741264507174492,-0.09582968801259995,0.029423613101243973,-0.019266100600361824,-0.027468698099255562,-0.12074770778417587,-0.027938051149249077,0.06416046619415283,-0.023004373535513878,0.015644019469618797,0.07666662335395813,0.013082114979624748,0.07054156810045242,0.007705856580287218,0.15848641097545624,0.04306816682219505,0.02760270982980728,-0.049236271530389786,0.031390100717544556,-0.02303900383412838,0.08083276450634003,0.04611315578222275,-0.011586278676986694,0.07105305790901184,-0.11210056394338608,-0.0240770373493433,0.015567627735435963,-0.10610129684209824,0.10883939266204834,-0.03401772305369377,0.019480863586068153,-0.0643589049577713,-0.04923319071531296,0.030492931604385376,0.049748267978429794,0.022048603743314743,-0.0942477211356163,0.06468653678894043,0.06397118419408798,-0.06087760999798775,-0.006533512379974127,-0.06713908910751343,-0.015625404193997383,0.022568371146917343,0.01640186831355095,0.07460804283618927,0.01009918749332428,0.03102961741387844,0.005832426715642214,-0.06013818457722664,-0.07227122038602829,0.09837114065885544,-0.009827205911278725,0.033933866769075394,0.06996829062700272,-0.04452798143029213,0.05524139106273651,0.05179906263947487,0.0021631759591400623,0.005675732623785734,-0.06327345222234726,-0.03792278468608856,-0.040572237223386765,-0.05048425868153572,-8.774840515593781e-33,0.05064363405108452,-0.06509274244308472,-0.03593708202242851,0.016625646501779556,0.011716613546013832,0.09324835240840912,-0.021788669750094414,-0.05348002910614014,0.05194825679063797,0.06264380365610123,-0.03233354911208153,-0.03400030359625816,0.01913621835410595,-0.05539314076304436,-0.02989719994366169,0.02442953549325466,-0.028711728751659393,-0.05962725356221199,0.01331369113177061,0.006301108282059431,0.0322134792804718,-0.03034329228103161,-0.017785290256142616,0.0681937113404274,0.03268785402178764,-0.04573506861925125,-0.09904742240905762,-0.006972225848585367,-0.06383052468299866,-0.03675690293312073,0.04607754945755005,-0.0125655522570014,-0.05476941168308258,-0.034957751631736755,-0.006163839716464281,-0.004613715689629316,-0.004465379286557436,-0.01404250506311655,0.011801348067820072,0.008980701677501202,0.025542594492435455,0.060393206775188446,-0.0071901436895132065,-0.018470117822289467,0.022061021998524666,0.08783935755491257,-0.026915475726127625,0.08986523002386093,-0.02910807356238365,-0.03355580195784569,-0.10739277303218842,0.02202768065035343,0.004516070708632469,-0.00999145396053791,0.01929038017988205,-0.0869826152920723,-0.01896001398563385,0.05230797082185745,-0.018399670720100403,0.028372200205922127,0.004794626496732235,0.003998200409114361,-0.05478712543845177,0.009103626012802124]'),
      sentence_embedding("racial tensions"), 
      2
    )
  );
